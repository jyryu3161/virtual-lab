# Metabolic Modeling Configuration File
# This file controls all parameters for genome-scale metabolic analysis

# ============================================================================
# MODEL CONFIGURATION
# ============================================================================
model:
  # Model source - choose one
  source: "bigg"          # Options: bigg, file

  # If source = "bigg", specify model ID from BiGG database
  bigg_id: "iML1515"      # E. coli model
  # Other options: textbook, iJO1366, Recon3D, iMM904

  # If source = "file", specify file path
  file_path: null
  file_format: "json"     # Options: json, xml, mat, sbml

  # Model modifications
  modifications:
    # Set specific bounds
    custom_bounds: {}
      # Example:
      # EX_glc__D_e: [-10, 0]  # Glucose uptake rate
      # EX_o2_e: [-20, 0]       # Oxygen uptake rate

    # Set objective function
    objective: "BIOMASS_Ec_iML1515_core_75p37M"  # Will be auto-detected if null

    # Growth medium
    medium: "default"       # Options: default, minimal, rich, custom
    custom_medium: {}       # If medium = "custom"

# ============================================================================
# OUTPUT CONFIGURATION
# ============================================================================
output:
  # Output directory for all results
  output_dir: "../metabolic_results"

  # File naming
  prefix: "metabolic_analysis"

  # What to save
  save_results: true
  save_plots: true
  save_model: false       # Save modified model
  save_intermediate: false

# ============================================================================
# ANALYSIS METHODS
# ============================================================================
methods:
  # Which analyses to perform
  # Options: single, double, essential, fva, production, pathway
  enabled:
    - single
    - essential
    - fva

  # Single Gene Knockout
  single_knockout:
    growth_threshold: 0.05  # Below this = essential
    processes: -1           # Parallel processes (-1 = all CPUs)
    save_lethal_only: false

  # Double Gene Knockout
  double_knockout:
    growth_threshold: 0.05
    max_pairs: 10000        # Limit pairs to test (or null for all)
    only_synthetic_lethal: true
    processes: -1

  # Essential Gene Analysis
  essential_genes:
    growth_threshold: 0.05
    rank_by: "growth_impact"  # Options: growth_impact, flux_change
    include_reactions: true    # Include associated reactions

  # Flux Variability Analysis
  fva:
    fraction_of_optimum: 0.9  # Fraction of optimal growth
    processes: -1
    reactions: "all"           # Or list specific reactions
    loopless: false           # Loopless FVA (slower)

  # Growth-Coupled Production
  production:
    enabled: false
    target_metabolite: "succ_c"  # Succinate (cytoplasm)
    growth_threshold: 0.05
    min_production: 0.1

  # Heterologous Pathway Design
  pathway_design:
    enabled: false
    target_compound: "13ppd_c"   # 1,3-propanediol
    pathway_template: "1-3-propanediol"  # Options: ethanol, succinate, 1-3-propanediol, custom

    # Custom pathway (if pathway_template = "custom")
    custom_pathway:
      metabolites: []
        # Example:
        # - id: "new_met_c"
        #   name: "New Metabolite"
        #   formula: "C6H12O6"
        #   compartment: "c"

      reactions: []
        # Example:
        # - id: "NEW_RXN"
        #   name: "New Reaction"
        #   metabolites: {glc__D_c: -1, new_met_c: 1}
        #   gene_reaction_rule: "heterologous_gene"

    cofactor_balancing: true
    test_feasibility: true

# ============================================================================
# VISUALIZATION
# ============================================================================
visualization:
  enabled: true

  # Plot types
  plots:
    growth_impact: true
    flux_distribution: true
    essential_genes: true
    pathway_map: false      # Requires escher (optional)

  # Growth impact plot
  growth_impact:
    top_n: 30
    colormap: "RdYlGn"

  # Flux distribution
  flux_distribution:
    subsystems: "all"       # Or list specific subsystems
    show_zero_flux: false

  # Figure settings
  figure:
    dpi: 300
    format: "pdf"
    style: "seaborn-v0_8"

# ============================================================================
# AI AGENT CONFIGURATION (for AI-guided workflow)
# ============================================================================
agent:
  # Whether to use AI agents
  enabled: false

  # Workflow type
  workflow: "production"    # Options: production, drug_discovery, pathway_design

  # OpenAI API
  api:
    model: "gpt-4"
    temperature: 0.7
    max_tokens: 2000

  # PubMed search
  pubmed:
    enabled: true
    max_results: 10
    search_terms:
      - "metabolic engineering"
      - "gene knockout"
      - "flux balance analysis"

  # Discussion settings
  discussion:
    save_logs: true
    log_format: "both"
    verbosity: "detailed"

# ============================================================================
# OPTIMIZATION PARAMETERS
# ============================================================================
optimization:
  # Solver settings
  solver: "glpk"            # Options: glpk, cplex, gurobi
  tolerance: 1e-6

  # FBA parameters
  fba:
    objective_sense: "maximize"
    pfba: false             # Parsimonious FBA

  # Timeout (seconds)
  timeout: 60

# ============================================================================
# VALIDATION AND CONSTRAINTS
# ============================================================================
validation:
  # Check model consistency
  check_mass_balance: true
  check_reaction_bounds: true
  check_objective: true

  # Experimental constraints (optional)
  experimental_data:
    growth_rate: null       # Observed growth rate
    secretion_rates: {}     # Metabolite secretion rates
    uptake_rates: {}        # Metabolite uptake rates

# ============================================================================
# ADVANCED OPTIONS
# ============================================================================
advanced:
  # Random seed
  random_seed: 42

  # Parallel processing
  n_jobs: -1

  # Memory management
  low_memory_mode: false

  # Logging
  log_level: "INFO"
  log_file: "metabolic_analysis.log"

  # Cache
  use_cache: true
  cache_dir: ".cache"
